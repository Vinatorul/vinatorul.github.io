---
title:  "Наименьший общий предок (LCA)"
date:   2018-06-19
categories: [Задачи]
tags: [lca]
---

Ниже представлено описание задачи, приведены ссылки на сторонние ресурсы с материалами, а также на задачи, которые можно решить для практики по данной теме.

<!--more-->

Задача поиска наименьшего общего предка в общем виде формулируется следующим образом:

Пусть задано дерево $T$, подвесим его за некоторую вершину и назовём её корнем.
Требуется для данных вершин $u$ и $v$ найти наиболее удалённую от корня дерева вершину, лежащую на обоих путях от $u$ и $v$ до корня. 

## Алгоритмы решения

### Алгоритм $O(n)$ на построение, $O(n)$ на запрос

Описание тривиального алгоритма:

Обходом в глубину посчитаем глубину каждой вершины дерева. Напомню, что глубиной называется длина пути до вершины от корня дерева.
Дальше для вершин $u$ и $v$ рассмотрим всех предков с одинаковой глубиной, из одинаковых предков возьмём ту вершину, глубина которой больше.

Очевидно, что сложность такого алгоритма $O(n)$ на предварительные посторения (обход в глубину), и $O(n)$ на запрос.

### Алгоритм $O(n \log_2 n)$ на построение, $O(\log_2 n)$ на запрос

Одним из самых простых быстрых алгоритмов нахождения LCA является <<Метод двоичного подъема>>. Почитать описание и посмотреть примеры реализации можно здесь:
 * [Викиконспекты - Метод двоичного подъема](https://neerc.ifmo.ru/wiki/index.php?title=%D0%9C%D0%B5%D1%82%D0%BE%D0%B4_%D0%B4%D0%B2%D0%BE%D0%B8%D1%87%D0%BD%D0%BE%D0%B3%D0%BE_%D0%BF%D0%BE%D0%B4%D1%8A%D0%B5%D0%BC%D0%B0)
 * [E-Maxx - Метод двоичного подъёма](http://e-maxx.ru/algo/lca_simpler)

### Алгоритмы $O(n)$ на построение, $O(\log_2 n)$ или  $O(\sqrt{n})$ на запрос

Алгоритмы, основанные на сведении задачи LCA к задаче поиска минимума на отрезке (RMQ). Почитать подробнее можно здесь:
 * [E-maxx - LCA к RMQ](http://e-maxx.ru/algo/lca)

### Алгоритм $O(n)$ на построение, $O(1)$ на запрос (алгоритм Фарах-Колтона и Бендера)

 * [E-maxx - LCA за O(1)](http://e-maxx.ru/algo/lca_linear)

## Задачи

### Простые
 * [Timus - 1471. Расстояние в дереве](http://acm.timus.ru/problem.aspx?space=1&num=1471)
 * [SPOJ - POLICEMEN](https://www.spoj.com/problems/POLICEMEN/)

### Средние
 * [Codeforces - 832D. Миша, Гриша и метро](http://codeforces.com/contest/832/problem/D)
 * [Timus - 1752. Дерево 2](http://acm.timus.ru/problem.aspx?space=1&num=1752)
 * [SPOJ - NTICKETS](https://www.spoj.com/problems/NTICKETS/)
 * [SPOJ - QTREE2](https://www.spoj.com/problems/QTREE2/)
 * [SPOJ - DRTREE](https://www.spoj.com/problems/DRTREE/)
 * [SPOJ - GRASSPLA](https://www.spoj.com/problems/GRASSPLA/)

### Сложные
 * [Codeforces - 733F. Недовольство автомобилистов](http://codeforces.com/contest/733/problem/F)
 * [Codeforces - 828F. Лучший вес для ребра](http://codeforces.com/contest/828/problem/F)
 * [Codeforces - 838B. Расходящиеся направления](http://codeforces.com/problemset/problem/838/B)
 * [Codeforces - 1051F. Самое короткое условие](http://codeforces.com/contest/1051/problem/F)


